{% extends 'shop/base.html' %}

{% block title %}Ø±Ø²Ø±Ùˆ Ù†ÙˆØ¨Øª Ø¢Ù†Ù„Ø§ÛŒÙ†{% endblock %}

{% block content %}
<style>
    .appointment-container {
        max-width: 800px;
        margin: 40px auto;
    }
    
    .appointment-header {
        text-align: center;
        margin-bottom: 40px;
    }
    
    .appointment-card {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    
    .form-section {
        margin-bottom: 30px;
    }
    
    .form-section h3 {
        color: #4361ee;
        border-bottom: 2px solid #4361ee;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #333;
    }
    
    .form-group select,
    .form-group input {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 16px;
    }
    
    .form-group input:focus,
    .form-group select:focus {
        border-color: #4361ee;
        outline: none;
    }
    
    .service-card {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s;
        border: 2px solid #ddd;
    }
    
    .service-card:hover {
        background: #e8f4fd;
        border-color: #4361ee;
    }
    
    .service-card.selected {
        background: #e8f4fd;
        border-color: #4361ee;
        box-shadow: 0 5px 15px rgba(67, 97, 238, 0.2);
    }
    
    .submit-btn {
        width: 100%;
        padding: 16px;
        background: linear-gradient(135deg, #4361ee, #3a0ca3);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.3s;
    }
    
    .submit-btn:hover {
        transform: translateY(-3px);
    }
    
    .login-warning {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        text-align: center;
    }
</style>

<div class="appointment-container">
    <div class="appointment-header">
        <h1>ğŸ“… Ø±Ø²Ø±Ùˆ Ù†ÙˆØ¨Øª Ø¢Ù†Ù„Ø§ÛŒÙ†</h1>
        <p>Ù†ÙˆØ¨Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ùˆ Ø¯Ø± Ú©Ù…ØªØ± Ø§Ø² Û² Ø¯Ù‚ÛŒÙ‚Ù‡ Ø±Ø²Ø±Ùˆ Ú©Ù†ÛŒØ¯</p>
    </div>
    
    {% if not user.is_authenticated %}
    <div class="login-warning">
        <strong>ğŸ’¡ ØªÙˆØ¬Ù‡:</strong> Ø¨Ø±Ø§ÛŒ Ø±Ø²Ø±Ùˆ Ù†ÙˆØ¨Øª Ø¨Ø§ÛŒØ¯ 
        <a href="{% url 'login' %}">ÙˆØ§Ø±Ø¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</a> Ø´ÙˆÛŒØ¯. 
        Ø§Ú¯Ø± Ø­Ø³Ø§Ø¨ Ù†Ø¯Ø§Ø±ÛŒØ¯ØŒ <a href="{% url 'shop:register' %}">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†ÛŒØ¯</a>.
    </div>
    {% endif %}
    
    <div class="appointment-card">
        <form method="post" id="appointmentForm">
            {% csrf_token %}
            
            <!-- Ø¨Ø®Ø´ Û±: Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø±ÙˆÛŒØ³ -->
            <div class="form-section">
                <h3>Û±. Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ø³Ø±ÙˆÛŒØ³</h3>
                <div id="servicesList">
                    {% for service in services %}
                    <div class="service-card" data-id="{{ service.id }}">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>{{ service.name }}</strong>
                                <p style="color: #666; margin: 5px 0; font-size: 0.9rem;">
                                    {{ service.description }}
                                </p>
                            </div>
                            <div style="color: #2ecc71; font-weight: bold;">
                                {{ service.price }} ØªÙˆÙ…Ø§Ù†
                            </div>
                        </div>
                        <input type="radio" name="service" value="{{ service.id }}" required 
                               style="display: none;" id="service_{{ service.id }}">
                    </div>
                    {% empty %}
                    <p style="text-align: center; color: #666;">Ù‡ÛŒÚ† Ø³Ø±ÙˆÛŒØ³ÛŒ ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Ø¨Ø®Ø´ Û²: Ø§Ù†ØªØ®Ø§Ø¨ ØªÚ©Ù†Ø³ÛŒÙ† -->
            <div class="form-section">
                <h3>Û². Ø§Ù†ØªØ®Ø§Ø¨ Ù…ØªØ®ØµØµ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</h3>
                <div class="form-group">
                    <label for="technician">ØªÚ©Ù†Ø³ÛŒÙ† Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±:</label>
                    <select name="technician" id="technician">
                        <option value="">Ø¨Ø¯ÙˆÙ† ØªØ±Ø¬ÛŒØ­ (ØªØ®ØµÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø±)</option>
                        {% for tech in technicians %}
                        <option value="{{ tech.id }}">{{ tech.name }} - {{ tech.specialty }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <!-- Ø¨Ø®Ø´ Û³: Ø§Ù†ØªØ®Ø§Ø¨ Ø²Ù…Ø§Ù† -->
            <div class="form-section">
                <h3>Û³. Ø§Ù†ØªØ®Ø§Ø¨ Ø²Ù…Ø§Ù† Ù…Ø±Ø§Ø¬Ø¹Ù‡</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label for="date">ØªØ§Ø±ÛŒØ®:</label>
                        <input type="date" id="date" name="date" required 
                               min="{% now 'Y-m-d' %}" 
                               onchange="updateAvailableTimes()">
                    </div>
                    
                    <div class="form-group">
                        <label for="time">Ø³Ø§Ø¹Øª:</label>
                        <select id="time" name="time" required>
                            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                            <option value="08:00">08:00</option>
                            <option value="08:30">08:30</option>
                            <option value="09:00">09:00</option>
                            <option value="09:30">09:30</option>
                            <option value="10:00">10:00</option>
                            <option value="10:30">10:30</option>
                            <option value="11:00">11:00</option>
                            <option value="11:30">11:30</option>
                            <option value="12:00">12:00</option>
                            <option value="12:30">12:30</option>
                            <option value="13:00">13:00</option>
                            <option value="13:30">13:30</option>
                            <option value="14:00">14:00</option>
                            <option value="14:30">14:30</option>
                            <option value="15:00">15:00</option>
                            <option value="15:30">15:30</option>
                            <option value="16:00">16:00</option>
                            <option value="16:30">16:30</option>
                            <option value="17:00">17:00</option>
                            <option value="17:30">17:30</option>
                            <option value="18:00">18:00</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ -->
            <button type="submit" class="submit-btn" {% if not user.is_authenticated %}disabled{% endif %}>
                {% if user.is_authenticated %}
                âœ… ØªØ£ÛŒÛŒØ¯ Ùˆ Ø±Ø²Ø±Ùˆ Ù†ÙˆØ¨Øª
                {% else %}
                ğŸ”’ Ø¨Ø±Ø§ÛŒ Ø±Ø²Ø±Ùˆ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯
                {% endif %}
            </button>
        </form>
    </div>
</div>

<script>
    // Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø±ÙˆÛŒØ³ Ø¨Ø§ Ú©Ù„ÛŒÚ©
    document.querySelectorAll('.service-card').forEach(card => {
        card.addEventListener('click', function() {
            // Ø­Ø°Ù Ø§Ù†ØªØ®Ø§Ø¨ Ù‚Ø¨Ù„ÛŒ
            document.querySelectorAll('.service-card').forEach(c => {
                c.classList.remove('selected');
            });
            
            // Ø§Ù†ØªØ®Ø§Ø¨ Ø¬Ø¯ÛŒØ¯
            this.classList.add('selected');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
        });
    });
    
    // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø±ÙˆØ²Ù‡Ø§ÛŒ Ú¯Ø°Ø´ØªÙ‡
    document.addEventListener('DOMContentLoaded', function() {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('date').setAttribute('min', today);
    });
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø³Ø§Ø¹Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ (Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø¨Ø¹Ø¯Ø§Ù‹ Ú©Ø§Ù…Ù„Ø´ Ú©Ù†ÛŒ)
    function updateAvailableTimes() {
        console.log('ØªØ§Ø±ÛŒØ® ØªØºÛŒÛŒØ± Ú©Ø±Ø¯. Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø¨Ø§ Ajax Ø³Ø§Ø¹Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø± Ø±Ùˆ Ú†Ú© Ú©Ù†ÛŒ');
    }

</script>
{% endblock %}